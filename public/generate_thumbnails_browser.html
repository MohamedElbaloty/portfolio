<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generate Animation Thumbnails</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #1a1a1a;
            color: #fff;
        }
        .container {
            background: #2a2a2a;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        button {
            background: #6366f1;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #4f46e5;
        }
        button:disabled {
            background: #555;
            cursor: not-allowed;
        }
        .thumbnail-preview {
            display: inline-block;
            margin: 10px;
            text-align: center;
        }
        .thumbnail-preview img {
            max-width: 200px;
            border: 2px solid #6366f1;
            border-radius: 5px;
        }
        .status {
            margin: 10px 0;
            padding: 10px;
            background: #333;
            border-radius: 5px;
        }
        .success { color: #10b981; }
        .error { color: #ef4444; }
        .info { color: #3b82f6; }
    </style>
</head>
<body>
    <h1>ğŸ¬ Generate Animation Thumbnails</h1>
    <div class="container">
        <p>This tool will extract thumbnails from animation videos and allow you to download them.</p>
        <button id="generateAll">Generate All Thumbnails</button>
        <div id="status"></div>
    </div>
    
    <div id="thumbnails" class="container"></div>

    <script>
        const subProjects = {
            "logo-animation": [
                "/logo animation/1.mp4",
                "/logo animation/2.mp4",
                "/logo animation/3.mp4",
                "/logo animation/4.mp4",
                "/logo animation/5.mp4",
                "/logo animation/6.mp4"
            ],
            "motion-graphics": [
                "/2D3DAnimation/Ø§Ù„Ù…Ù†ØµØ© Ø§Ù„ØªØ·ÙˆØ¹ÙŠØ©.mp4",
                "/2D3DAnimation/Ø³Ø§Ø¨Ù„.mp4",
                "/2D3DAnimation/Ù…Ù„Ù….mp4",
                "/2D3DAnimation/Ù†Ø§Ø¬Ø².mp4",
                "/2D3DAnimation/Ù‡ÙŠØ¦Ø© ÙƒÙØ§Ø¡Ø© Ø§Ù„Ø§Ù†ÙØ§Ù‚.mp4",
                "/2D3DAnimation/ÙˆØ²Ø§Ø±Ø© Ø§Ù„Ø¨Ù„Ø¯ÙŠØ§Øª ÙˆØ§Ù„Ø§Ø³ÙƒØ§Ù†.mp4",
                "/2D3DAnimation/ÙˆØ²Ø§Ø±Ø© Ø§Ù„Ø·Ø§Ù‚Ø©.mp4",
                "/2D3DAnimation/ÙˆØ²Ø§Ø±Ø© Ø§Ù„Ù†Ù‚Ù„ ÙˆØ§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù„ÙˆØ¬ÙŠØ³ØªÙŠÙ‡.mp4"
            ],
            "conference-motion": [
                "/conferenceeventscreenmotion/classeraeventvideo.mp4",
                "/conferenceeventscreenmotion/Ø£Ø¨Ø´Ø± Ø§Ø¹Ù…Ø§Ù„ reel Ø¬Ù†Ø§Ø­ ÙˆØ²Ø§Ø±Ø© Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©.mp4",
                "/conferenceeventscreenmotion/Ø§Ø¹Ù„Ø§Ù† Ù…Ø³Ø§Ø¨Ù‚Ø© Ù…Ù†Ù‚ÙŠØ©.mp4",
                "/conferenceeventscreenmotion/Ø§Ù„Ø´Ø±ÙƒØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠÙ‡ Ù„Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¡.mp4",
                "/conferenceeventscreenmotion/Ø§ÙŠÙÙ†Øª Ø§Ù„Ø§Ù…Ù† Ø§Ù„Ø¨ÙŠØ¦ÙŠ.mp4"
            ],
            "paper-animation": [
                "/paperstyleanimation/Ø§Ø¹Ù„Ø§Ù† Ø³ÙˆØ´Ø§Ù„ Ù…ÙŠØ¯ÙŠØ§ Ø´Ø§ÙˆØ±Ù…Ø§ Ø¬Ù„ÙŠÙ„Ø©.mp4",
                "/paperstyleanimation/Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù‚Ø±Ø§Ù† Ø¨Ø§Ù„Ø²Ù„ÙÙ‰.mp4",
                "/paperstyleanimation/Ù‡ÙŠØ¦Ø© ÙÙ†ÙˆÙ† Ø§Ù„Ø·Ù‡ÙŠ.mp4"
            ]
        };

        function updateStatus(message, type = 'info') {
            const statusDiv = document.getElementById('status');
            statusDiv.innerHTML = `<div class="status ${type}">${message}</div>`;
        }

        function extractThumbnail(videoPath, subProjectId) {
            return new Promise((resolve, reject) => {
                const video = document.createElement('video');
                video.preload = 'metadata';
                video.muted = true;
                video.crossOrigin = 'anonymous';
                video.src = videoPath;

                // For motion-graphics, try later times to avoid black frames
                const timesToTry = subProjectId === 'motion-graphics' 
                    ? [2.0, 3.0, 4.0, 5.0, 1.0] 
                    : [0.5, 1.0, 2.0, 3.0, 4.0];
                
                let bestCanvas = null;
                let bestBrightness = 0;
                let attempts = 0;

                const tryTime = (timeIndex) => {
                    if (timeIndex >= timesToTry.length) {
                        if (bestCanvas) {
                            resolve(bestCanvas);
                        } else {
                            reject(new Error('Could not extract frame'));
                        }
                        return;
                    }

                    const time = timesToTry[timeIndex];
                    video.currentTime = time;

                    const checkFrame = () => {
                        try {
                            const canvas = document.createElement('canvas');
                            canvas.width = video.videoWidth || 640;
                            canvas.height = video.videoHeight || 360;
                            const ctx = canvas.getContext('2d');
                            ctx.drawImage(video, 0, 0, canvas.width, canvas.height);

                            // Calculate brightness
                            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                            let brightness = 0;
                            for (let i = 0; i < imageData.data.length; i += 4) {
                                brightness += (imageData.data[i] + imageData.data[i + 1] + imageData.data[i + 2]) / 3;
                            }
                            brightness /= (imageData.data.length / 4);

                            if (brightness > 30 && brightness > bestBrightness) {
                                bestCanvas = canvas;
                                bestBrightness = brightness;
                            }

                            attempts++;
                            if (bestBrightness > 30 || attempts >= timesToTry.length) {
                                if (bestCanvas) {
                                    resolve(bestCanvas);
                                } else {
                                    tryTime(timeIndex + 1);
                                }
                            } else {
                                tryTime(timeIndex + 1);
                            }
                        } catch (e) {
                            tryTime(timeIndex + 1);
                        }
                    };

                    video.addEventListener('seeked', checkFrame, { once: true });
                    setTimeout(() => {
                        if (attempts < timeIndex + 1) {
                            tryTime(timeIndex + 1);
                        }
                    }, 1000);
                };

                video.addEventListener('loadedmetadata', () => {
                    tryTime(0);
                });

                video.addEventListener('error', (e) => {
                    reject(new Error('Video load error'));
                });
            });
        }

        function downloadCanvas(canvas, filename) {
            canvas.toBlob((blob) => {
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                a.click();
                URL.revokeObjectURL(url);
            }, 'image/jpeg', 0.85);
        }

        async function generateThumbnail(subProjectId, videoPath) {
            try {
                updateStatus(`Processing ${subProjectId}...`, 'info');
                const canvas = await extractThumbnail(videoPath, subProjectId);
                
                // Resize to standard size
                const resizedCanvas = document.createElement('canvas');
                const ctx = resizedCanvas.getContext('2d');
                const aspectRatio = canvas.width / canvas.height;
                
                if (aspectRatio > 1.5) {
                    resizedCanvas.width = 640;
                    resizedCanvas.height = 640 / aspectRatio;
                } else {
                    resizedCanvas.height = 360;
                    resizedCanvas.width = 360 * aspectRatio;
                }
                
                ctx.drawImage(canvas, 0, 0, resizedCanvas.width, resizedCanvas.height);
                
                // Display preview
                const previewDiv = document.createElement('div');
                previewDiv.className = 'thumbnail-preview';
                const imgDataUrl = resizedCanvas.toDataURL('image/jpeg', 0.85);
                previewDiv.innerHTML = `
                    <img src="${imgDataUrl}" alt="${subProjectId}">
                    <p>${subProjectId}</p>
                    <button onclick="this.downloadCanvas = function(canvas, name) {
                        canvas.toBlob((blob) => {
                            const url = URL.createObjectURL(blob);
                            const a = document.createElement('a');
                            a.href = url;
                            a.download = name;
                            a.click();
                            URL.revokeObjectURL(url);
                        }, 'image/jpeg', 0.85);
                    }; downloadCanvas(document.createElement('canvas').getContext('2d').canvas, '${subProjectId}.jpg')">Download</button>
                `;
                document.getElementById('thumbnails').appendChild(previewDiv);
                
                // Auto download
                downloadCanvas(resizedCanvas, `${subProjectId}.jpg`);
                
                return true;
            } catch (e) {
                updateStatus(`Error processing ${subProjectId}: ${e.message}`, 'error');
                return false;
            }
        }

        async function generateAll() {
            const button = document.getElementById('generateAll');
            button.disabled = true;
            document.getElementById('thumbnails').innerHTML = '';
            
            updateStatus('Starting thumbnail generation...', 'info');
            
            for (const [subProjectId, videos] of Object.entries(subProjects)) {
                if (videos.length > 0) {
                    await generateThumbnail(subProjectId, videos[0]);
                    await new Promise(resolve => setTimeout(resolve, 500)); // Small delay
                }
            }
            
            updateStatus('âœ… All thumbnails generated! Check downloads folder.', 'success');
            button.disabled = false;
        }

        document.getElementById('generateAll').addEventListener('click', generateAll);
    </script>
</body>
</html>

